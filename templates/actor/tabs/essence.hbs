<div class="hwfwm-card">
  <div class="hwfwm-card__title">Essences</div>

  <nav class="hwfwm-tabs" data-group="essence">
    <a class="hwfwm-tab {{#if (eq system._ui.essenceSubTab "power")}}is-active{{/if}}" data-tab="power">Power</a>
    <a class="hwfwm-tab {{#if (eq system._ui.essenceSubTab "speed")}}is-active{{/if}}" data-tab="speed">Speed</a>
    <a class="hwfwm-tab {{#if (eq system._ui.essenceSubTab "spirit")}}is-active{{/if}}" data-tab="spirit">Spirit</a>
    <a class="hwfwm-tab {{#if (eq system._ui.essenceSubTab "recovery")}}is-active{{/if}}" data-tab="recovery">Recovery</a>
  </nav>

  {{!-- =========================================================
       POWER
       ========================================================= --}}
  <section class="tab" data-group="essence" data-tab="power">
    <div class="hwfwm-spec-add">

      {{!-- Essence dropdown: show unless this is the confluence slot (after unlock) --}}
      {{#if essenceUI.confluenceUnlocked}}
        {{#if (eq essenceUI.confluenceSlot "power")}}
          {{!-- hidden --}}
        {{else}}
          <label>Essence</label>
          <select name="system.essences.powerKey">
            <option value="">— Select Essence —</option>
            {{#each essenceCatalog as |e key|}}
              <option value="{{key}}" {{#if (eq key ../system.essences.powerKey)}}selected{{/if}}>{{e.name}}</option>
            {{/each}}
          </select>
        {{/if}}
      {{else}}
        <label>Essence</label>
        <select name="system.essences.powerKey">
          <option value="">— Select Essence —</option>
          {{#each essenceCatalog as |e key|}}
            <option value="{{key}}" {{#if (eq key ../system.essences.powerKey)}}selected{{/if}}>{{e.name}}</option>
          {{/each}}
        </select>
      {{/if}}

      {{!-- Confluence dropdown: only on the remaining slot after unlock --}}
      {{#if essenceUI.confluenceUnlocked}}
        {{#if (eq essenceUI.confluenceSlot "power")}}
          <label>Confluence</label>
          <select name="system.confluenceEssences.powerKey">
            <option value="">— Select Confluence —</option>
            {{#each confluenceEssenceCatalog as |c key|}}
              <option value="{{key}}" {{#if (eq key ../system.confluenceEssences.powerKey)}}selected{{/if}}>{{c.name}}</option>
            {{/each}}
          </select>
        {{/if}}
      {{/if}}

    </div>

    {{!-- Slots render if essence chosen OR (confluence slot and confluence chosen) --}}
    {{#if system.essences.powerKey}}
      <div class="hwfwm-spec-table">
        <div class="hwfwm-spec-head"><div>Essence Ability Slots (Power)</div></div>
        <div class="hwfwm-spec-row"><div class="hwfwm-spec-name">Slot 1</div></div>
        <div class="hwfwm-spec-row"><div class="hwfwm-spec-name">Slot 2</div></div>
        <div class="hwfwm-spec-row">
