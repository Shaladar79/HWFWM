{{!-- templates/actor/tabs/treasures/equipment.hbs --}}

{{!-- EQUIPMENT SUBTAB: shows only equipped equipment + readied consumables (derived, not duplicated) --}}
<section class="tab" data-group="treasures" data-tab="equipment">

  {{!-- Equipped Equipment --}}
  <div class="hwfwm-res-separator">Equipped Equipment</div>
  {{#if equippedEquipment.length}}
    <div class="hwfwm-treasure-list">
      {{#each equippedEquipment as |it|}}
        <div class="hwfwm-treasure-row">
          <div class="hwfwm-treasure-name">{{it.name}}</div>
          <div class="hwfwm-treasure-meta">Type: {{it.category}}</div>
          <div class="hwfwm-itemlist__actions">
            <button type="button" class="hwfwm-itembtn" data-action="open-item" data-item-id="{{it.id}}">Edit</button>
            <button type="button" class="hwfwm-itembtn hwfwm-itembtn--danger" data-action="delete-item" data-item-id="{{it.id}}">Delete</button>
          </div>
        </div>
      {{/each}}
    </div>
  {{else}}
    <div class="hwfwm-muted">No equipped items yet.</div>
  {{/if}}

  {{!-- Readied Consumables (Derived Snapshot) --}}
  <div class="hwfwm-res-separator">Readied Consumables</div>

  {{!-- harden against missing derived paths --}}
  {{#if (and system._derived system._derived.consumables)}}
    {{#if system._derived.consumables.readiedItems.length}}
      <div class="hwfwm-treasure-list">
        {{#each system._derived.consumables.readiedItems as |it|}}
          <div class="hwfwm-treasure-row">
            <div class="hwfwm-treasure-name">{{it.name}}</div>

            <div class="hwfwm-treasure-meta">
              {{#if it.quantity}}Qty: {{it.quantity}}{{/if}}
              {{#if it.category}}&nbsp;|&nbsp;Cat: {{it.category}}{{/if}}
              {{#if it.itemRank}}&nbsp;|&nbsp;Rank: {{it.itemRank}}{{/if}}
              {{#if it.actionCost}}&nbsp;|&nbsp;AC: {{it.actionCost}}{{/if}}
            </div>

            <div class="hwfwm-itemlist__actions">
              <button type="button" class="hwfwm-itembtn" data-action="open-item" data-item-id="{{it.id}}">Edit</button>
              <button type="button" class="hwfwm-itembtn hwfwm-itembtn--danger" data-action="delete-item" data-item-id="{{it.id}}">Delete</button>
            </div>
          </div>
        {{/each}}
      </div>
    {{else}}
      <div class="hwfwm-muted">No readied consumables yet.</div>
    {{/if}}
  {{else}}
    <div class="hwfwm-muted">No readied consumables yet.</div>
  {{/if}}
</section>
